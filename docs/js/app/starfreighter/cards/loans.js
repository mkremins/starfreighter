// Compiled by ClojureScript 1.9.227 {:static-fns true, :optimize-constants true}
goog.provide('starfreighter.cards.loans');
goog.require('cljs.core');
goog.require('starfreighter.db');
goog.require('starfreighter.desc');
goog.require('starfreighter.gen');
goog.require('starfreighter.rand');
goog.require('starfreighter.util');
starfreighter.cards.loans.cards = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 5, [cljs.core.cst$kw$id,cljs.core.cst$kw$offer_DASH_loan,cljs.core.cst$kw$prereq,cljs.core.every_pred.cljs$core$IFn$_invoke$arity$2(cljs.core.complement(starfreighter.db.can_afford_QMARK_.cljs$core$IFn$_invoke$arity$1((30000))),cljs.core.complement(cljs.core.cst$kw$loan_DASH_info)),cljs.core.cst$kw$bind,new cljs.core.PersistentArrayMap(null, 1, [cljs.core.cst$kw$lender,starfreighter.db.some_trusting_merchant], null),cljs.core.cst$kw$weight,(function (p1__22219_SHARP_){
return starfreighter.util.bucket(cljs.core.cst$kw$cash.cljs$core$IFn$_invoke$arity$1(p1__22219_SHARP_),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(10000),(4)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(20000),(3)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(30000),(2)], null)], null));
}),cljs.core.cst$kw$gen,(function (p__22227){
var map__22228 = p__22227;
var map__22228__$1 = ((((!((map__22228 == null)))?((((map__22228.cljs$lang$protocol_mask$partition0$ & (64))) || (map__22228.cljs$core$ISeq$))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__22228):map__22228);
var state = map__22228__$1;
var map__22229 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__22228__$1,cljs.core.cst$kw$bound);
var map__22229__$1 = ((((!((map__22229 == null)))?((((map__22229.cljs$lang$protocol_mask$partition0$ & (64))) || (map__22229.cljs$core$ISeq$))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__22229):map__22229);
var lender = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__22229__$1,cljs.core.cst$kw$lender);
var amount = (40000);
return new cljs.core.PersistentArrayMap(null, 5, [cljs.core.cst$kw$type,cljs.core.cst$kw$yes_DASH_no,cljs.core.cst$kw$speaker,lender,cljs.core.cst$kw$text,new cljs.core.PersistentVector(null, 8, 5, cljs.core.PersistentVector.EMPTY_NODE, [starfreighter.desc.r.cljs$core$IFn$_invoke$arity$variadic(cljs.core.array_seq(["Greetings, Captain!","Hello, Captain.","So,","So, Captain,"], 0))," I hear tell you\u2019re ",starfreighter.desc.r.cljs$core$IFn$_invoke$arity$variadic(cljs.core.array_seq(["running a bit short on","strapped for"], 0))," cash. I could certainly lend you, say,",new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$cash,amount], null),"\u2026 ","provided you agree to pay it back promptly, plus a bit of interest.",starfreighter.desc.r.cljs$core$IFn$_invoke$arity$variadic(cljs.core.array_seq(["Do we have a deal?","What do you say?"], 0))], null),cljs.core.cst$kw$yes,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$call,((function (amount,map__22228,map__22228__$1,state,map__22229,map__22229__$1,lender){
return (function (p1__22220_SHARP_){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(p1__22220_SHARP_,cljs.core.cst$kw$loan_DASH_info,new cljs.core.PersistentArrayMap(null, 4, [cljs.core.cst$kw$amount,amount,cljs.core.cst$kw$lender,lender,cljs.core.cst$kw$collector,starfreighter.gen.gen_local_character.cljs$core$IFn$_invoke$arity$1(state),cljs.core.cst$kw$turn_DASH_borrowed,cljs.core.cst$kw$turn.cljs$core$IFn$_invoke$arity$1(state)], null));
});})(amount,map__22228,map__22228__$1,state,map__22229,map__22229__$1,lender))
], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$earn,amount], null)], null),cljs.core.cst$kw$no,cljs.core.PersistentVector.EMPTY], null);
})], null),new cljs.core.PersistentArrayMap(null, 4, [cljs.core.cst$kw$id,cljs.core.cst$kw$collect_DASH_loan,cljs.core.cst$kw$prereq,(function (p1__22221_SHARP_){
var and__6392__auto__ = cljs.core.cst$kw$loan_DASH_info.cljs$core$IFn$_invoke$arity$1(p1__22221_SHARP_);
if(cljs.core.truth_(and__6392__auto__)){
return (cljs.core.not(cljs.core.cst$kw$collection_DASH_failed_QMARK_.cljs$core$IFn$_invoke$arity$1(cljs.core.cst$kw$loan_DASH_info.cljs$core$IFn$_invoke$arity$1(p1__22221_SHARP_)))) && (((cljs.core.cst$kw$turn.cljs$core$IFn$_invoke$arity$1(p1__22221_SHARP_) - cljs.core.cst$kw$turn_DASH_borrowed.cljs$core$IFn$_invoke$arity$1(cljs.core.cst$kw$loan_DASH_info.cljs$core$IFn$_invoke$arity$1(p1__22221_SHARP_))) >= (20)));
} else {
return and__6392__auto__;
}
}),cljs.core.cst$kw$weight,(function (p1__22222_SHARP_){
return starfreighter.util.bucket((cljs.core.cst$kw$turn.cljs$core$IFn$_invoke$arity$1(p1__22222_SHARP_) - cljs.core.cst$kw$turn_DASH_borrowed.cljs$core$IFn$_invoke$arity$1(cljs.core.cst$kw$loan_DASH_info.cljs$core$IFn$_invoke$arity$1(p1__22222_SHARP_))),new cljs.core.PersistentVector(null, 7, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(25),(1)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(30),(2)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(35),(4)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(40),(8)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(45),(16)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(50),(32)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(1000),(100)], null)], null));
}),cljs.core.cst$kw$gen,(function (state){
var map__22232 = cljs.core.cst$kw$loan_DASH_info.cljs$core$IFn$_invoke$arity$1(state);
var map__22232__$1 = ((((!((map__22232 == null)))?((((map__22232.cljs$lang$protocol_mask$partition0$ & (64))) || (map__22232.cljs$core$ISeq$))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__22232):map__22232);
var amount = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__22232__$1,cljs.core.cst$kw$amount);
var collector = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__22232__$1,cljs.core.cst$kw$collector);
var lender = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__22232__$1,cljs.core.cst$kw$lender);
var interest = (10000);
var total = (amount + interest);
var pay_up = new cljs.core.PersistentArrayMap(null, 4, [cljs.core.cst$kw$type,cljs.core.cst$kw$info,cljs.core.cst$kw$speaker,collector,cljs.core.cst$kw$text,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, ["Pleasure doing business with you, Captain.",cljs.core.cst$kw$shortname.cljs$core$IFn$_invoke$arity$1(lender)," sends their regards!"], null),cljs.core.cst$kw$ok,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$call,((function (map__22232,map__22232__$1,amount,collector,lender,interest,total){
return (function (p1__22223_SHARP_){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(p1__22223_SHARP_,cljs.core.cst$kw$loan_DASH_info);
});})(map__22232,map__22232__$1,amount,collector,lender,interest,total))
], null)], null)], null);
var surrender = new cljs.core.PersistentArrayMap(null, 2, [cljs.core.cst$kw$type,cljs.core.cst$kw$game_DASH_over,cljs.core.cst$kw$text,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, ["Your ship is repossessed and your remaining assets seized. Your only hope is that they are ","collectively worth enough to clear the debt and keep you out of indentured servitude to ",cljs.core.cst$kw$name.cljs$core$IFn$_invoke$arity$1(lender),"."], null)], null);
var fight_outcome = (function (){var fight_score = cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(cljs.core._PLUS_,cljs.core.map.cljs$core$IFn$_invoke$arity$2(((function (map__22232,map__22232__$1,amount,collector,lender,interest,total,pay_up,surrender){
return (function (p1__22224_SHARP_){
if(cljs.core.truth_((starfreighter.db.fighter_QMARK_.cljs$core$IFn$_invoke$arity$1 ? starfreighter.db.fighter_QMARK_.cljs$core$IFn$_invoke$arity$1(p1__22224_SHARP_) : starfreighter.db.fighter_QMARK_.call(null,p1__22224_SHARP_)))){
return (2);
} else {
return (1);
}
});})(map__22232,map__22232__$1,amount,collector,lender,interest,total,pay_up,surrender))
,starfreighter.db.crew(state)));
var enemy_fight_score = starfreighter.rand.rand_int_STAR_.cljs$core$IFn$_invoke$arity$2((2),(5));
if((fight_score > enemy_fight_score)){
return new cljs.core.PersistentArrayMap(null, 4, [cljs.core.cst$kw$type,cljs.core.cst$kw$info,cljs.core.cst$kw$speaker,starfreighter.db.some_preferably.cljs$core$IFn$_invoke$arity$3(state,starfreighter.db.fighter_QMARK_,starfreighter.db.crew),cljs.core.cst$kw$text,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, ["Yee-haw, look at \u2018em run! All you gotta do is zap the leader ","and the rest\u2019ll go running for the hills."], null),cljs.core.cst$kw$ok,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$call,((function (fight_score,enemy_fight_score,map__22232,map__22232__$1,amount,collector,lender,interest,total,pay_up,surrender){
return (function (p1__22225_SHARP_){
return cljs.core.assoc_in(p1__22225_SHARP_,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$loan_DASH_info,cljs.core.cst$kw$collection_DASH_failed_QMARK_], null),true);
});})(fight_score,enemy_fight_score,map__22232,map__22232__$1,amount,collector,lender,interest,total,pay_up,surrender))
], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$add_DASH_whole_DASH_crew_DASH_memory,cljs.core.cst$kw$won_DASH_collector_DASH_fight], null)], null)], null);
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(fight_score,enemy_fight_score)){
return new cljs.core.PersistentArrayMap(null, 4, [cljs.core.cst$kw$type,cljs.core.cst$kw$info,cljs.core.cst$kw$speaker,collector,cljs.core.cst$kw$text,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, ["Well then\u2026 looks like this is my cue to exit. When next we meet,","please do try to be a bit more civil \u2013 otherwise I might have to do ","something we\u2019ll both regret."], null),cljs.core.cst$kw$ok,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$call,((function (fight_score,enemy_fight_score,map__22232,map__22232__$1,amount,collector,lender,interest,total,pay_up,surrender){
return (function (p1__22226_SHARP_){
return cljs.core.assoc_in(p1__22226_SHARP_,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$loan_DASH_info,cljs.core.cst$kw$collection_DASH_failed_QMARK_], null),true);
});})(fight_score,enemy_fight_score,map__22232,map__22232__$1,amount,collector,lender,interest,total,pay_up,surrender))
], null)], null)], null);
} else {
if((fight_score < enemy_fight_score)){
return new cljs.core.PersistentArrayMap(null, 3, [cljs.core.cst$kw$type,cljs.core.cst$kw$game_DASH_over,cljs.core.cst$kw$deadly_QMARK_,true,cljs.core.cst$kw$text,new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, ["All at once, your chest lights up with pain, and you instinctively ","gasp for air. The last thing you see before you lose consciousness is ","the slight frown of disapproval on ",cljs.core.cst$kw$name.cljs$core$IFn$_invoke$arity$1(collector),"\u2019s face."], null)], null);
} else {
return null;
}
}
}
})();
var fight = new cljs.core.PersistentArrayMap(null, 4, [cljs.core.cst$kw$type,cljs.core.cst$kw$info,cljs.core.cst$kw$text,new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, ["You\u2019re not sure who shoots first. Your crew are quick on the draw,","but so are ",cljs.core.cst$kw$shortname.cljs$core$IFn$_invoke$arity$1(collector),"\u2019s goons. Dust flies in your face ","as you duck for cover, the air around you full of searing light."], null),cljs.core.cst$kw$icon,"\uD83D\uDCA5",cljs.core.cst$kw$ok,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$set_DASH_next_DASH_card,fight_outcome], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$add_DASH_memory,lender,cljs.core.cst$kw$refused_DASH_repay_DASH_fought_DASH_collector], null)], null)], null);
var cant_afford = new cljs.core.PersistentArrayMap(null, 5, [cljs.core.cst$kw$type,cljs.core.cst$kw$yes_DASH_no,cljs.core.cst$kw$speaker,collector,cljs.core.cst$kw$text,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, ["Ah, you can\u2019t afford it? That is indeed a problem.","In that case, I\u2019m afraid I\u2019ll have to ask you to surrender your vessel ","and submit to arrest. We must recoup our losses somehow\u2026"], null),cljs.core.cst$kw$yes,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$spend,(100)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$set_DASH_next_DASH_card,surrender], null)], null),cljs.core.cst$kw$no,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$set_DASH_next_DASH_card,fight], null)], null)], null);
return new cljs.core.PersistentArrayMap(null, 5, [cljs.core.cst$kw$type,cljs.core.cst$kw$yes_DASH_no,cljs.core.cst$kw$speaker,collector,cljs.core.cst$kw$text,new cljs.core.PersistentVector(null, 19, 5, cljs.core.PersistentVector.EMPTY_NODE, ["Hello, Captain. Remember that",new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$cash,amount], null),"you borrowed from",new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$link,lender], null),starfreighter.desc.o(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, ["back on",new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$link,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$places,cljs.core.cst$kw$home.cljs$core$IFn$_invoke$arity$1(lender)], null)], null)], null)),"? Well, ",starfreighter.desc.r.cljs$core$IFn$_invoke$arity$variadic(cljs.core.array_seq(["I\u2019m here to collect it","I\u2019ve been sent to collect it","it\u2019s time to pay up"], 0)),"!",starfreighter.desc.r.cljs$core$IFn$_invoke$arity$variadic(cljs.core.array_seq(["Counting","Including","Plus","With"], 0))," interest,",starfreighter.desc.r.cljs$core$IFn$_invoke$arity$variadic(cljs.core.array_seq(["the amount owed","the debt"], 0)),"comes out to",new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$cash,total], null),starfreighter.desc.r.cljs$core$IFn$_invoke$arity$variadic(cljs.core.array_seq(["in all","total",""], 0)),".",starfreighter.desc.o("Now,"),"can we",starfreighter.desc.o(" all")," agree to do this the easy way?"], null),cljs.core.cst$kw$yes,(cljs.core.truth_(starfreighter.db.can_afford_QMARK_.cljs$core$IFn$_invoke$arity$2(state,(amount + interest)))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$spend,total], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$set_DASH_next_DASH_card,pay_up], null)], null):new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$set_DASH_next_DASH_card,cant_afford], null)], null)),cljs.core.cst$kw$no,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.cst$kw$set_DASH_next_DASH_card,fight], null)], null)], null);
})], null)], null);
